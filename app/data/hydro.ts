const riverFlow = [
  {
    Station_Number: '2260100',
    Month: 1,
    Value: 99.6290322581,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.7586602576
  },
  {
    Station_Number: '2260100',
    Month: 2,
    Value: 66.1268436578,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.7753041637
  },
  {
    Station_Number: '2260100',
    Month: 3,
    Value: 64.7715053763,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.7759774966
  },
  {
    Station_Number: '2260100',
    Month: 4,
    Value: 149.8986111111,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.7336863026
  },
  {
    Station_Number: '2260100',
    Month: 5,
    Value: 371.3387096774,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.6236747373
  },
  {
    Station_Number: '2260100',
    Month: 6,
    Value: 2472.1194444444,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: 0.4199943116
  },
  {
    Station_Number: '2260100',
    Month: 7,
    Value: 5874.7768817204,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: 2.1104364375
  },
  {
    Station_Number: '2260100',
    Month: 8,
    Value: 4551.7150537634,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: 1.4531385783
  },
  {
    Station_Number: '2260100',
    Month: 9,
    Value: 3356.4194444444,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: 0.8593150483
  },
  {
    Station_Number: '2260100',
    Month: 10,
    Value: 1790.9825268817,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: 0.0816051084
  },
  {
    Station_Number: '2260100',
    Month: 11,
    Value: 545.05,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.5373748707
  },
  {
    Station_Number: '2260100',
    Month: 12,
    Value: 177.8266129032,
    Mean: 1626.7212221865,
    Std: 2012.8801720974,
    Z_Score: -0.7198116556
  },
  {
    Station_Number: '2260110',
    Month: 1,
    Value: 625.2459677419,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.7762199359
  },
  {
    Station_Number: '2260110',
    Month: 2,
    Value: 472.01179941,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.8140901046
  },
  {
    Station_Number: '2260110',
    Month: 3,
    Value: 402.9865591398,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.8311489467
  },
  {
    Station_Number: '2260110',
    Month: 4,
    Value: 494.1944444444,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.8086079036
  },
  {
    Station_Number: '2260110',
    Month: 5,
    Value: 986.5551075269,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.6869262867
  },
  {
    Station_Number: '2260110',
    Month: 6,
    Value: 4626.7541666667,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: 0.2127095703
  },
  {
    Station_Number: '2260110',
    Month: 7,
    Value: 11057.7002688172,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: 1.8020483988
  },
  {
    Station_Number: '2260110',
    Month: 8,
    Value: 10312.4072580645,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: 1.6178572857
  },
  {
    Station_Number: '2260110',
    Month: 9,
    Value: 8239.6458333333,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: 1.1055967004
  },
  {
    Station_Number: '2260110',
    Month: 10,
    Value: 5064.6478494624,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: 0.3209302616
  },
  {
    Station_Number: '2260110',
    Month: 11,
    Value: 1955.3222222222,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.447505964
  },
  {
    Station_Number: '2260110',
    Month: 12,
    Value: 955.3306451613,
    Mean: 3766.0668434992,
    Std: 4046.3027687524,
    Z_Score: -0.6946430752
  },
  {
    Station_Number: '2260120',
    Month: 1,
    Value: 976.373655914,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.769490957
  },
  {
    Station_Number: '2260120',
    Month: 2,
    Value: 788.4631268437,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.8133246236
  },
  {
    Station_Number: '2260120',
    Month: 3,
    Value: 659.2620967742,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.8434631949
  },
  {
    Station_Number: '2260120',
    Month: 4,
    Value: 691.675,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.8359022753
  },
  {
    Station_Number: '2260120',
    Month: 5,
    Value: 1202.4637096774,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.7167511979
  },
  {
    Station_Number: '2260120',
    Month: 6,
    Value: 4440.725,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: 0.0386341783
  },
  {
    Station_Number: '2260120',
    Month: 7,
    Value: 11096.1021505376,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: 1.5911261244
  },
  {
    Station_Number: '2260120',
    Month: 8,
    Value: 11417.0107526882,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: 1.665984094
  },
  {
    Station_Number: '2260120',
    Month: 9,
    Value: 9764.5833333333,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: 1.2805243068
  },
  {
    Station_Number: '2260120',
    Month: 10,
    Value: 6389.7607526882,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: 0.4932834401
  },
  {
    Station_Number: '2260120',
    Month: 11,
    Value: 2512.6972222222,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.4111145781
  },
  {
    Station_Number: '2260120',
    Month: 12,
    Value: 1362.1330645161,
    Mean: 4275.1041554329,
    Std: 4286.8996307537,
    Z_Score: -0.6795053166
  },
  {
    Station_Number: '2260400',
    Month: 1,
    Value: 1144.3951612903,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.9283142028
  },
  {
    Station_Number: '2260400',
    Month: 2,
    Value: 1089.7536873156,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.9418576718
  },
  {
    Station_Number: '2260400',
    Month: 3,
    Value: 1317.0080645161,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.8855302638
  },
  {
    Station_Number: '2260400',
    Month: 4,
    Value: 2220.1736111111,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.6616711027
  },
  {
    Station_Number: '2260400',
    Month: 5,
    Value: 3138.3884408602,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.4340818172
  },
  {
    Station_Number: '2260400',
    Month: 6,
    Value: 7653.4791666667,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: 0.685031313
  },
  {
    Station_Number: '2260400',
    Month: 7,
    Value: 12033.2741935484,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: 1.770609969
  },
  {
    Station_Number: '2260400',
    Month: 8,
    Value: 10708.7567204301,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: 1.4423142635
  },
  {
    Station_Number: '2260400',
    Month: 9,
    Value: 9091.6125,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: 1.0414879146
  },
  {
    Station_Number: '2260400',
    Month: 10,
    Value: 6059.8185483871,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: 0.290025624
  },
  {
    Station_Number: '2260400',
    Month: 11,
    Value: 2665.0263888889,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.551409623
  },
  {
    Station_Number: '2260400',
    Month: 12,
    Value: 1554.7459677419,
    Mean: 4889.7027042297,
    Std: 4034.5257364931,
    Z_Score: -0.8266044027
  },
  {
    Station_Number: '2260500',
    Month: 1,
    Value: 1040.7755376344,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.8798378677
  },
  {
    Station_Number: '2260500',
    Month: 2,
    Value: 839.4351032448,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.91689937
  },
  {
    Station_Number: '2260500',
    Month: 3,
    Value: 983.9301075269,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.890301623
  },
  {
    Station_Number: '2260500',
    Month: 4,
    Value: 1765.7069444444,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.7463969767
  },
  {
    Station_Number: '2260500',
    Month: 5,
    Value: 2825.6989247312,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.5512802071
  },
  {
    Station_Number: '2260500',
    Month: 6,
    Value: 7251.2097222222,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: 0.2633404568
  },
  {
    Station_Number: '2260500',
    Month: 7,
    Value: 14495.436827957,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: 1.5968129901
  },
  {
    Station_Number: '2260500',
    Month: 8,
    Value: 14613.622311828,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: 1.6185678432
  },
  {
    Station_Number: '2260500',
    Month: 9,
    Value: 12438.4333333333,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: 1.2181725056
  },
  {
    Station_Number: '2260500',
    Month: 10,
    Value: 8447.9502688172,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: 0.4836290569
  },
  {
    Station_Number: '2260500',
    Month: 11,
    Value: 3511.6847222222,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.4250081831
  },
  {
    Station_Number: '2260500',
    Month: 12,
    Value: 1633.1424731183,
    Mean: 5820.58552309,
    Std: 5432.6031657033,
    Z_Score: -0.7707986249
  },
  {
    Station_Number: '2260600',
    Month: 1,
    Value: 3518.6196236559,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.8504328002
  },
  {
    Station_Number: '2260600',
    Month: 2,
    Value: 3001.0604719764,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.9062761474
  },
  {
    Station_Number: '2260600',
    Month: 3,
    Value: 2968.4032258065,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.9097997832
  },
  {
    Station_Number: '2260600',
    Month: 4,
    Value: 3829.1888888889,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.8169231477
  },
  {
    Station_Number: '2260600',
    Month: 5,
    Value: 5548.2446236559,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.6314413028
  },
  {
    Station_Number: '2260600',
    Month: 6,
    Value: 12019.4277777778,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: 0.0667832897
  },
  {
    Station_Number: '2260600',
    Month: 7,
    Value: 24121.7970430108,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: 1.3725988799
  },
  {
    Station_Number: '2260600',
    Month: 8,
    Value: 26575.8360215054,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: 1.6373835916
  },
  {
    Station_Number: '2260600',
    Month: 9,
    Value: 24207.9541666667,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: 1.3818950196
  },
  {
    Station_Number: '2260600',
    Month: 10,
    Value: 17760.1411290323,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: 0.6861920045
  },
  {
    Station_Number: '2260600',
    Month: 11,
    Value: 8494.7013888889,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.3135259347
  },
  {
    Station_Number: '2260600',
    Month: 12,
    Value: 4760.3454301075,
    Mean: 11400.4766492477,
    Std: 9268.0538940045,
    Z_Score: -0.7164536692
  },
  {
    Station_Number: '2260700',
    Month: 1,
    Value: 2834.9112903226,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.8270047316
  },
  {
    Station_Number: '2260700',
    Month: 2,
    Value: 2275.8628318584,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.8814560101
  },
  {
    Station_Number: '2260700',
    Month: 3,
    Value: 2201.3172043011,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.8887167487
  },
  {
    Station_Number: '2260700',
    Month: 4,
    Value: 2881.6166666667,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.8224556314
  },
  {
    Station_Number: '2260700',
    Month: 5,
    Value: 4492.4825268817,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.6655574157
  },
  {
    Station_Number: '2260700',
    Month: 6,
    Value: 11246.4430555556,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.0077221597
  },
  {
    Station_Number: '2260700',
    Month: 7,
    Value: 25286.4583333333,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: 1.3597742901
  },
  {
    Station_Number: '2260700',
    Month: 8,
    Value: 28370.2647849462,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: 1.6601368104
  },
  {
    Station_Number: '2260700',
    Month: 9,
    Value: 25657.3722222222,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: 1.3959012754
  },
  {
    Station_Number: '2260700',
    Month: 10,
    Value: 18436.6048387097,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: 0.6925990663
  },
  {
    Station_Number: '2260700',
    Month: 11,
    Value: 8177.9597222222,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.3065922094
  },
  {
    Station_Number: '2260700',
    Month: 12,
    Value: 4047.4193548387,
    Mean: 11325.7260693215,
    Std: 10266.9482470403,
    Z_Score: -0.7089065357
  }
]
const riverStations = [
  { Station_Number: '2260100', Station_Name: 'HKAMTI', Latitude: 26.0, Longitude: 95.7 },
  { Station_Number: '2260110', Station_Name: 'MAWLAIK', Latitude: 23.63, Longitude: 94.42 },
  { Station_Number: '2260120', Station_Name: 'MONYWA', Latitude: 22.1, Longitude: 95.13 },
  { Station_Number: '2260400', Station_Name: 'KATHA', Latitude: 24.17, Longitude: 96.33 },
  { Station_Number: '2260500', Station_Name: 'SAGAING', Latitude: 21.98, Longitude: 96.1 },
  { Station_Number: '2260600', Station_Name: 'MAGWAY', Latitude: 20.13, Longitude: 94.92 },
  { Station_Number: '2260700', Station_Name: 'PYAY', Latitude: 18.8, Longitude: 95.22 }
]

interface ZScoreResult {
  date: Date
  zScore: number
}

export function getZScoresForClosestStation(
  longitude: number,
  latitude: number,
  startDate: Date,
  numberOfDays: number
): ZScoreResult[] {
  // Helper function to calculate the distance between two points (Haversine formula)
  function calculateDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {
    const R = 6371 // Radius of the Earth in km
    const dLat = ((lat2 - lat1) * Math.PI) / 180
    const dLon = ((lon2 - lon1) * Math.PI) / 180
    const a =
      Math.sin(dLat / 2) * Math.sin(dLat / 2) +
      Math.cos((lat1 * Math.PI) / 180) *
        Math.cos((lat2 * Math.PI) / 180) *
        Math.sin(dLon / 2) *
        Math.sin(dLon / 2)
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))
    return R * c
  }

  // Find the closest station
  let closestStation = riverStations[0]
  let minDistance = calculateDistance(
    latitude,
    longitude,
    closestStation.Latitude,
    closestStation.Longitude
  )

  for (let i = 1; i < riverStations.length; i++) {
    const station = riverStations[i]
    const distance = calculateDistance(latitude, longitude, station.Latitude, station.Longitude)
    if (distance < minDistance) {
      closestStation = station
      minDistance = distance
    }
  }

  // Get Z-Scores for the closest station
  const stationNumber = closestStation.Station_Number
  const stationFlowData = riverFlow.filter(data => data.Station_Number === stationNumber)

  // Generate the Z-Scores for each day
  const results: ZScoreResult[] = []
  let currentDate = new Date(startDate)

  for (let i = 0; i < numberOfDays; i++) {
    const month = currentDate.getMonth() + 1 // Month is zero-based, so add 1
    const flowDataForMonth = stationFlowData.find(data => data.Month === month)

    if (flowDataForMonth) {
      results.push({
        date: new Date(currentDate),
        zScore: flowDataForMonth.Z_Score
      })
    }

    // Move to the next day
    currentDate.setDate(currentDate.getDate() + 1)
  }

  return results
}
